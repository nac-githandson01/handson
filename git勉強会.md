# 7/18 GitFlow勉強会

## 目標

- gitについて基本的に理解している
- gitの基本的な操作がコマンドラインベースでできる
- GitHubFlowでチームでの開発ができる

## 対象

- gitを今まで触ったことのない人
- GitHubFlow(GitFlow)での開発経験のない人
- GitをCLIで操作したことのない人

## Git is なに？

- gitは分散型バージョン管理システムです
- Subversionとの違いは分散型か集中型かです。
- 集中型はリモートにのみリポジトリがあり、分散型はローカル、リモートリポジトリがあります。
- SVNとGitどちらがいいかはわかりません。ただしOSSでの標準はGitになりつつあります。

## GitHub is なに？

- GitHubは一番メジャーなGitホスティングサービスです
- GitホスティングサービスにはほかにGitLab、BitBucketなどがあります。

## GitHubFlowを使うと何がうれしいの？

- 開発(コーディング)におけるコミュニケーションが集約されます。またそのためのツールが用意されています。
- pullRequestというシステムのため、コードレビューが必須の運用になり品質の向上が見込めます。
- その他連携するツールによりCI（継続的インテグレーション）等が可能になり、コーディング〜テスト〜デプロイまでが流れ作業的に行うことができます。（今回は取り扱いません）

## GitHubFlow is なに？

- GitHubFlowはGit-Flowから派生した開発ワークフローです。
- 原則は下記です

    1. masterブランチを常にデプロイできる状態にしておく

    1. 新しい作業をするときはmasterブランチを作成し、そのブランチで作業する

    1. 作成したローカルリポジトリのブランチにコミットする

    1. 同名のブランチをGithubのリポジトリに作成し、定期的にプッシュする

    1. 助けてほしい時やフィードバックがほしいときはプルリクエストを作成し、プルリクエストでやりとりする

    1. 他の開発者がレビューし、作業終了を確認したらmasterブランチにマージする

    1. masterブランチへマージしたら、直ちにデプロイする

- ![図解](https://raw.githubusercontent.com/tbpgr/github_flow_for_ja/master/github_flow_gviz.png)

## ハンズオン

- 以下の手順で進めます。
    1. リモートリポジトリの作成
    1. リポジトリのクローン
    1. ブランチの作成
    1. 変更のコミット
    1. リモートへのプッシュ
    1. プルリクエスト
    1. マージ

- 管理者がリモートリポジトリを作成し、開発者が機能を追加するところというケースになります。
- そのため開発者側が行う操作を重点的にやります


1. リモートリポジトリの作成
    - 管理者側が行う操作です。
    - GitHubからCreateNewRipositoryを行います
    - ここのタイミングで「master」ブランチが作成されます

1. リポジトリのクローン

    - 作成されたリポジトリからローカルに持ってきます。
    - 「CloneOrDownload」から「Clone with HTTPS」のURLをコピーします
    - ターミナルからCloneコマンドを叩きます
    
    ``` bash
    $ git clone [URL]
    ```

    - SSHプロトコルによっても可能です（今回は扱いません）
    - ここのタイミングでGitConfigを編集します（Cloud９特有の問題のため）
    
    ``` bash
    $ cd [dirname]
    $ git config --local user.name "[NAME]"
    $ git config --local user.email "[EMAILADDRESS]"
    $ git config --local --list
    ```

1. masterブランチから新規ブランチを切る
    
    - masterブランチから開発用ブランチを切ります
    - ブランチの名前は「追加する機能名」とかでつけます。ただしこれも現場によります。（私のとこはfuture-チケットナンバー。ITSドリブンなので）
    
    ``` bash
    $ git branch -a
    $ git checkout -b [branchName]
    $ git branch -a
    ```

1. 変更のコミット

    - ここでファイルを追加したり変更したりします。
    - 変更の区切りでコミットをします
    - 基本的にコミットコメントは必須です。
    - またコメントが変更をしっかりと表したコメントをつけましょう
    - 「git commit -m "hogehoge" -m "fugafuga"」といったように複数行のコメントもできます
    - git管理にしたくないファイル(アカウント情報等)の場外リスト(.gitignore)というファイルを作ることもできます。(今回は飛ばします)

    ``` bash
    $ git diff [master]
    $ git add [fileName / 変更のあったすべてのファイルの場合「.」]
    $ git commit "[コメント]"
    ```
    - これらを繰り返します。

1. リモートへのプッシュ

    - ローカルでの開発が終わったらリモートリポジトリにpushします。
    - これは定期的に行ってください。
    - リモートにpushすることで他の開発者が進行状況を知ることができます

    ``` bash
    $ git push origin [branchName]
    ```


1. プルリクエスト
    - ここからはGitHubでの操作になります。
    - もうmasterに乗っけてもいいかな？もしくはここは相談したいなってタイミングでPullRequestします
    - タイトルにプルリクエストの目的をかき、コメントに変更内容と理由等を書きます（ここも現場ルールがあると思います）
    - もし作業中に相談したい場合はタイトルの頭に「[WIP]」つけてコメントに相談したい箇所と内容を書きましょう

1. コードレビュー
    - プルリクエストを投げたらレビュアーとコードレビューを行います。
    - 相談ごともここのdisscussでやります
    - 「@username」でメンションもできます。
    - レビューはその言語らしく書けてるか、仕様に問題はないか等、観点を決めて行うとレビュアーもレビュイーも幸せになります。観点によってはレビュアーを変えたりします
    - レビュアーは悪いコードを憎むべきですが、コーダーを憎んではいけません。
    - 参考になるコードレビューでのコミュニケーション、レビュアーもレビュイーも必読だと思います[コードレビューで気をつける言葉や行い](http://macotox.hateblo.jp/entry/2014/08/16/231842)
    - OKが出るまで変更->プッシュ->コードレビューを繰り返します。

1. マージ
    - コードレビューによって問題がなくなったらmasterにマージします。（通常これは管理者のしごとです）


### 参考・引用
- https://github.com/tbpgr/github_flow_for_ja
- http://macotox.hateblo.jp/entry/2014/08/16/231842